<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RPG Panel - Advanced</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- CSS GENERAL --- */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { display: flex; background-color: #121212; color: #e0e0e0; height: 100vh; overflow: hidden; }

        /* --- SCROLLBAR CUSTOM --- */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #1a1a1a; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #00ff88; }

        /* --- LOGIN STYLES --- */
        #auth-container {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            display: flex; justify-content: center; align-items: center; z-index: 100;
        }
        .auth-box {
            background: rgba(255, 255, 255, 0.05); padding: 40px; border-radius: 15px;
            backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1);
            width: 350px; text-align: center; box-shadow: 0 0 30px rgba(0,0,0,0.7);
        }
        .auth-box h2 { margin-bottom: 20px; color: #fff; }
        .auth-box input {
            width: 100%; padding: 12px; margin: 10px 0; background: rgba(0,0,0,0.3);
            border: 1px solid #444; color: #fff; border-radius: 5px; outline:none; transition: 0.3s;
        }
        .auth-box input:focus { border-color: #00ff88; }
        .btn-auth {
            width: 100%; padding: 12px; background: #00ff88; border: none;
            color: #000; font-weight: bold; cursor: pointer; border-radius: 5px; margin-top: 10px; transition: 0.3s;
        }
        .btn-auth:hover { background: #00cc6a; box-shadow: 0 0 15px rgba(0, 255, 136, 0.4); }
        .switch-auth { margin-top: 15px; font-size: 12px; cursor: pointer; color: #aaa; text-decoration: underline; }

        /* --- DASHBOARD CONTAINER --- */
        #dashboard-container { display: none; width: 100%; height: 100%; display: flex; }

        /* --- SIDEBAR --- */
        .sidebar {
            width: 260px; background-color: #1a1a1a; display: flex; flex-direction: column;
            padding: 25px; border-right: 1px solid #2a2a2a; box-shadow: 4px 0 15px rgba(0,0,0,0.3); z-index: 10;
        }
        .logo { margin-bottom: 40px; text-align: center; padding-bottom: 20px; border-bottom: 1px solid #333; }
        .logo h2 { color: #fff; font-weight: 800; letter-spacing: 1px; }
        .logo span { color: #00ff88; }
        .sidebar ul { list-style: none; }
        .sidebar ul li { margin-bottom: 10px; }
        .sidebar ul li a {
            text-decoration: none; color: #aaa; font-size: 15px; display: flex; align-items: center;
            padding: 12px 15px; border-radius: 8px; transition: all 0.2s ease; cursor: pointer;
        }
        .sidebar ul li a i { margin-right: 15px; width: 20px; text-align: center; }
        .sidebar ul li a:hover, .sidebar ul li.active a {
            background-color: rgba(0, 255, 136, 0.1); color: #00ff88; font-weight: 600; border-left: 3px solid #00ff88;
        }
        .logout { margin-top: auto; }
        .logout a { color: #ff4d4d !important; }
        .logout a:hover { background: rgba(255, 77, 77, 0.1) !important; }

        /* --- MAIN CONTENT AREA --- */
        .main-content {
            flex: 1; padding: 40px; overflow-y: auto;
            background: #141414; /* Flat dark bg for cleaner look */
        }

        /* --- HEADER COMUN --- */
        header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 40px; }
        .search-box {
            background: #1f1f1f; padding: 8px 15px; border-radius: 8px;
            display: flex; align-items: center; border: 1px solid #333; width: 300px;
        }
        .search-box input { background: transparent; border: none; color: #fff; margin-left: 10px; outline: none; width: 100%; }
        .user-mini-profile { display: flex; align-items: center; gap: 12px; }
        .user-mini-profile img { width: 45px; height: 45px; border-radius: 50%; border: 2px solid #333; }

        /* --- PAGES (Switchable) --- */
        .page-section { display: none; animation: fadeIn 0.3s ease; }
        .page-section.active-page { display: block; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- PAGE 1: DASHBOARD STATS --- */
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 25px; margin-bottom: 30px; }
        .card {
            background-color: #1f1f1f; padding: 25px; border-radius: 12px; position: relative;
            border: 1px solid #2a2a2a; transition: transform 0.2s;
        }
        .card:hover { transform: translateY(-3px); border-color: #00ff88; }
        .card i { font-size: 30px; margin-bottom: 15px; color: #00ff88; background: rgba(0,255,136,0.1); padding: 10px; border-radius: 10px; }
        .card h3 { font-size: 13px; color: #888; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 5px; }
        .card p { font-size: 26px; font-weight: 700; color: #fff; }

        /* --- PAGE 2: PROFILE DESIGN (NOU) --- */
        .profile-layout { display: grid; grid-template-columns: 300px 1fr; gap: 30px; }
        
        /* Coloana Stanga - Backpack/Info */
        .profile-sidebar .panel-card {
            background: #1f1f1f; border-radius: 12px; padding: 20px; border: 1px solid #2a2a2a; margin-bottom: 20px;
        }
        .backpack-item {
            display: flex; align-items: center; gap: 15px; padding: 10px; background: #181818; 
            border-radius: 8px; margin-top: 10px; border: 1px solid #333;
        }
        .backpack-icon { color: #00ff88; font-size: 24px; }
        
        /* Coloana Dreapta - Main Details */
        .profile-header-card {
            background: #1f1f1f; border-radius: 12px; padding: 30px; border: 1px solid #2a2a2a;
            display: flex; flex-direction: column; align-items: center; text-align: center; margin-bottom: 25px;
        }
        .big-avatar { width: 100px; height: 100px; border-radius: 50%; border: 3px solid #00ff88; margin-bottom: 15px; }
        .profile-name { font-size: 24px; font-weight: bold; color: #fff; }
        .profile-status { font-size: 14px; color: #00ff88; display: flex; align-items: center; gap: 5px; margin-bottom: 15px; }
        .status-dot { width: 8px; height: 8px; background: #00ff88; border-radius: 50%; display: inline-block; }
        
        .badges-container { display: flex; gap: 10px; justify-content: center; }
        .badge { padding: 5px 15px; border-radius: 20px; font-size: 12px; font-weight: bold; color: #fff; }
        .badge-vip { background: linear-gradient(45deg, #f1c40f, #f39c12); color: #000; }
        .badge-admin { background: linear-gradient(45deg, #e74c3c, #c0392b); }
        .badge-premium { background: linear-gradient(45deg, #9b59b6, #8e44ad); }

        /* Tabs Navigation */
        .profile-tabs { display: flex; gap: 20px; margin-bottom: 20px; border-bottom: 1px solid #333; padding-bottom: 10px; }
        .tab-btn { color: #888; cursor: pointer; padding: 10px; font-weight: 500; transition: 0.3s; display: flex; align-items: center; gap: 8px; }
        .tab-btn:hover { color: #fff; }
        .tab-btn.active-tab { color: #00ff88; border-bottom: 2px solid #00ff88; }

        /* Data Rows */
        .data-row {
            display: flex; justify-content: space-between; padding: 15px 0; border-bottom: 1px solid #2a2a2a;
            font-size: 14px;
        }
        .data-row:last-child { border-bottom: none; }
        .data-label { color: #888; font-weight: 500; }
        .data-value { color: #fff; font-weight: 600; }

        /* Warning Email */
        .email-warning {
            background: rgba(255, 77, 77, 0.1); border: 1px solid #ff4d4d; color: #ff4d4d;
            padding: 12px 20px; border-radius: 8px; margin-bottom: 30px; display: none; align-items: center; justify-content: space-between;
        }

        /* Responsive */
        @media (max-width: 900px) { .profile-layout { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

    <div id="auth-container">
        <div class="auth-box" id="login-form">
            <h2>üîê Login Panel</h2>
            <input type="email" id="login-email" placeholder="Email">
            <input type="password" id="login-pass" placeholder="ParolƒÉ">
            <button class="btn-auth" onclick="loginUser()">IntrƒÉ √Æn cont</button>
            <p class="switch-auth" onclick="toggleForms()">Nu ai cont? √énregistreazƒÉ-te</p>
        </div>
        <div class="auth-box" id="register-form" style="display: none;">
            <h2>üìù √énregistrare</h2>
            <input type="text" id="reg-roblox" placeholder="Nume Exact Roblox">
            <input type="email" id="reg-email" placeholder="Email">
            <input type="password" id="reg-pass" placeholder="ParolƒÉ">
            <button class="btn-auth" onclick="registerUser()">CreeazƒÉ Cont</button>
            <p class="switch-auth" onclick="toggleForms()">Ai deja cont? LogheazƒÉ-te</p>
        </div>
    </div>

    <div id="dashboard-container">
        
        <div class="sidebar">
            <div class="logo"><h2>SEVID<span>STUDIOS</span></h2></div>
            <ul>
                <li class="active" id="nav-dashboard" onclick="switchPage('dashboard')">
                    <a><i class="fas fa-chart-line"></i> Dashboard</a>
                </li>
                <li id="nav-profile" onclick="switchPage('profile')">
                    <a><i class="fas fa-user-circle"></i> Profilul Meu</a>
                </li>
                <li><a><i class="fas fa-users"></i> Fac»õiuni</a></li>
                <li><a><i class="fas fa-file-contract"></i> Reclama»õii</a></li>
                <li><a><i class="fas fa-store"></i> Shop Premium</a></li>
            </ul>
            <div class="logout"><a onclick="logoutUser()"><i class="fas fa-sign-out-alt"></i> Ie»ôire</a></div>
        </div>

        <div class="main-content">
            
            <div id="email-alert" class="email-warning">
                <div><i class="fas fa-exclamation-triangle"></i> Emailul <b><span id="alert-email-addr"></span></b> nu este confirmat!</div>
                <button onclick="resendVerification()" style="background:none; border:none; color:#fff; text-decoration:underline; cursor:pointer;">Retrimite Email</button>
            </div>

            <header>
                <div class="welcome-text">
                    <h1 id="page-title">Dashboard</h1>
                    <p style="color:#666; font-size:14px;">Bine ai venit pe panel!</p>
                </div>
                
                <div class="user-mini-profile">
                    <div class="search-box">
                        <i class="fas fa-search" style="color:#666"></i>
                        <input type="text" id="searchInput" placeholder="CautƒÉ jucƒÉtor...">
                        <i class="fas fa-arrow-right" style="color:#00ff88; cursor:pointer;" onclick="cautaJucatorManual()"></i>
                    </div>
                    <img src="https://tr.rbxcdn.com/535451733604f3780376d54833215904/150/150/AvatarHeadshot/Png" id="miniAvatar">
                </div>
            </header>

            <div id="page-dashboard" class="page-section active-page">
                <div class="stats-grid">
                    <div class="card"><i class="fas fa-wallet"></i><h3>Bani Cash</h3><p id="dash-cash">$0</p></div>
                    <div class="card"><i class="fas fa-university"></i><h3>Bani BancƒÉ</h3><p id="dash-bank">$0</p></div>
                    <div class="card"><i class="fas fa-briefcase"></i><h3>Job</h3><p id="dash-job">N/A</p></div>
                    <div class="card"><i class="fas fa-clock"></i><h3>Ore Jucate</h3><p id="dash-hours">0</p></div>
                </div>

                <div class="profile-header-card" style="align-items: flex-start; text-align: left; padding: 20px;">
                    <h3 style="color:#fff; margin-bottom: 15px; border-bottom: 1px solid #333; width:100%; padding-bottom:10px;">Jurnal Activitate</h3>
                    <div style="width:100%; color:#888; font-size:14px;">
                        <p><i class="fas fa-check-circle" style="color:#00ff88; margin-right:10px;"></i> Te-ai conectat la panel cu succes.</p>
                        <p style="margin-top:10px;"><i class="fas fa-server" style="color:#3498db; margin-right:10px;"></i> Date sincronizate din Roblox.</p>
                    </div>
                </div>
            </div>

            <div id="page-profile" class="page-section">
                
                <div class="profile-header-card">
                    <img src="" id="prof-big-avatar" class="big-avatar">
                    <div class="profile-name" id="prof-name">Jucator</div>
                    <div class="profile-status"><span class="status-dot"></span> Online pe Panel</div>
                    <div class="badges-container">
                        <span class="badge badge-vip"><i class="fas fa-crown"></i> VIP</span>
                        <span class="badge badge-premium"><i class="fas fa-gem"></i> Premium</span>
                        </div>
                </div>

                <div class="profile-layout">
                    <div class="profile-sidebar">
                        <div class="panel-card">
                            <h4 style="color:#fff; margin-bottom:15px; border-bottom:1px solid #333; padding-bottom:10px;">Backpack</h4>
                            <div class="backpack-item">
                                <i class="fas fa-box backpack-icon"></i>
                                <div>
                                    <div style="color:#fff; font-weight:600;">High Quality Kit</div>
                                    <div style="color:#666; font-size:12px;">Repara»õii Avansate</div>
                                </div>
                            </div>
                            <div class="backpack-item">
                                <i class="fas fa-mobile-alt backpack-icon" style="color:#3498db"></i>
                                <div>
                                    <div style="color:#fff; font-weight:600;">iPhone 14</div>
                                    <div style="color:#666; font-size:12px;">Telefon Mobil</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="profile-main">
                        <div class="profile-tabs">
                            <div class="tab-btn active-tab"><i class="fas fa-user"></i> Profile</div>
                            <div class="tab-btn"><i class="fas fa-home"></i> Properties</div>
                            <div class="tab-btn"><i class="fas fa-dumbbell"></i> Skills</div>
                            <div class="tab-btn"><i class="fas fa-history"></i> Faction History</div>
                        </div>

                        <div class="panel-card" style="background:#1f1f1f; padding: 25px; border-radius:12px; border:1px solid #2a2a2a;">
                            <div class="data-row">
                                <span class="data-label">Faction</span>
                                <span class="data-value" style="color:#3498db">Civilian</span>
                            </div>
                            <div class="data-row">
                                <span class="data-label">Faction Warn</span>
                                <span class="data-value">0/3</span>
                            </div>
                            <div class="data-row">
                                <span class="data-label">Level</span>
                                <span class="data-value" id="prof-level">1</span>
                            </div>
                            <div class="data-row">
                                <span class="data-label">Playing Hours</span>
                                <span class="data-value" id="prof-hours">0</span>
                            </div>
                            <div class="data-row">
                                <span class="data-label">Phone</span>
                                <span class="data-value">559-291</span>
                            </div>
                            <div class="data-row">
                                <span class="data-label">Register Date</span>
                                <span class="data-value">2025-01-20</span>
                            </div>
                            <div class="data-row">
                                <span class="data-label">Job</span>
                                <span class="data-value" id="prof-job" style="color:#f39c12">None</span>
                            </div>
                            <div class="data-row">
                                <span class="data-label">Referral ID</span>
                                <span class="data-value">#81596</span>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut, sendEmailVerification } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-auth.js";
        import { getDatabase, ref, set, get, child } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-database.js";

        // CONFIGURAREA TA (Nu o sterge!)
        const firebaseConfig = {
            apiKey: "AIzaSyDwD_aL4yioTc16MOCxz7cVec_eSKfABlo",
            authDomain: "projsmprobl.firebaseapp.com",
            databaseURL: "https://projsmprobl-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "projsmprobl",
            storageBucket: "projsmprobl.firebasestorage.app",
            messagingSenderId: "1024885479778",
            appId: "1:1024885479778:web:3ae2eab4fe383b76e8b43b",
            measurementId: "G-MNHTTG5XBB"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getDatabase(app);

        // --- SISTEM NAVIGARE ---
        window.switchPage = function(pageId) {
            // Ascunde toate paginile
            document.querySelectorAll('.page-section').forEach(el => el.classList.remove('active-page'));
            document.querySelectorAll('.sidebar li').forEach(el => el.classList.remove('active'));

            // Arata pagina selectata
            document.getElementById('page-' + pageId).classList.add('active-page');
            document.getElementById('nav-' + pageId).classList.add('active');

            // Actualizeaza titlul sus
            const titluri = {'dashboard': 'Dashboard', 'profile': 'Profilul Meu'};
            document.getElementById('page-title').innerText = titluri[pageId];
        }

        // --- AUTH LOGIC (Standard) ---
        window.toggleForms = function() {
            const login = document.getElementById('login-form');
            const reg = document.getElementById('register-form');
            if(login.style.display === 'none') { login.style.display = 'block'; reg.style.display = 'none'; }
            else { login.style.display = 'none'; reg.style.display = 'block'; }
        }

        window.registerUser = function() {
            const robloxName = document.getElementById('reg-roblox').value;
            const email = document.getElementById('reg-email').value;
            const pass = document.getElementById('reg-pass').value;
            if(!robloxName || !email || !pass) { alert("CompleteazƒÉ tot!"); return; }

            createUserWithEmailAndPassword(auth, email, pass).then((uc) => {
                set(ref(db, 'site_users/' + uc.user.uid), { robloxUsername: robloxName, email: email });
                sendEmailVerification(uc.user).then(() => { alert("Cont creat! VerificƒÉ mail-ul."); toggleForms(); });
            }).catch((e) => alert("Eroare: " + e.message));
        }

        window.loginUser = function() {
            const email = document.getElementById('login-email').value;
            const pass = document.getElementById('login-pass').value;
            signInWithEmailAndPassword(auth, email, pass).catch((e) => alert("Eroare: " + e.message));
        }

        window.logoutUser = function() { signOut(auth).then(() => location.reload()); }
        window.resendVerification = function() { if(auth.currentUser) sendEmailVerification(auth.currentUser).then(()=>alert("Trimis!")); }

        // --- MAIN LOGIC ---
        onAuthStateChanged(auth, async (user) => {
            const authDiv = document.getElementById('auth-container');
            const dashDiv = document.getElementById('dashboard-container');

            if (user) {
                authDiv.style.display = 'none';
                dashDiv.style.display = 'flex';

                if (!user.emailVerified) {
                    document.getElementById('email-alert').style.display = 'flex';
                    document.getElementById('alert-email-addr').innerText = user.email;
                } else {
                    document.getElementById('email-alert').style.display = 'none';
                }

                const snapshot = await get(child(ref(db), `site_users/${user.uid}`));
                if (snapshot.exists()) {
                    const myRobloxName = snapshot.val().robloxUsername;
                    // Incarcam datele in ambele pagini (Dashboard si Profil)
                    incarcaStats(myRobloxName);
                }
            } else {
                authDiv.style.display = 'flex';
                dashDiv.style.display = 'none';
            }
        });

        async function incarcaStats(numeRoblox) {
            try {
                const snapshot = await get(child(ref(db), `users/${numeRoblox}`));
                if (snapshot.exists()) {
                    const data = snapshot.val();
                    
                    // Actualizare Dashboard Simplu
                    document.getElementById('dash-cash').innerText = "$" + (data.banii_cash || 0).toLocaleString();
                    document.getElementById('dash-bank').innerText = "$" + (data.banii_banca || 0).toLocaleString();
                    document.getElementById('dash-job').innerText = data.job_curent || "N/A";
                    document.getElementById('dash-hours').innerText = data.ore_jucate || 0;
                    if(data.avatar_url) document.getElementById('miniAvatar').src = data.avatar_url;

                    // Actualizare Profil Detaliat (Nou)
                    document.getElementById('prof-name').innerText = numeRoblox;
                    document.getElementById('prof-level').innerText = "15"; // Placeholder sau data.level
                    document.getElementById('prof-hours').innerText = data.ore_jucate || 0;
                    document.getElementById('prof-job').innerText = data.job_curent || "N/A";
                    if(data.avatar_url) document.getElementById('prof-big-avatar').src = data.avatar_url;

                } else {
                    document.getElementById('prof-name').innerText = numeRoblox; // Macar numele sa apara
                }
            } catch (e) { console.error(e); }
        }

        window.cautaJucatorManual = function() {
            const nume = document.getElementById('searchInput').value;
            if(nume) incarcaStats(nume);
        }

        setInterval(async () => {
            if (auth.currentUser && !auth.currentUser.emailVerified) {
                await auth.currentUser.reload();
                if (auth.currentUser.emailVerified) {
                    document.getElementById('email-alert').style.display = 'none';
                }
            }
        }, 5000);
    </script>
</body>
</html>
